<!doctype html>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Experiment results</title>
<style>
* {
    box-sizing: border-box;
}

html {
    line-height: 1.15;
}

body {
    font-family: sans-serif;
    font-size: 16px;
}

table {
    border-collapse: collapse;
    border-spacing: 0;
}

td, th {
    border-right: 1px #dedede solid;
    border-bottom: 1px #dedede solid;
    padding: 5px;
    text-align: left;
}
td:first-child, th:first-child {
    border-left: 1px #dedede solid;
}
th {
    border-top: 1px #dedede solid;
}

tbody tr:nth-child(odd) {
    background-color: #f4f5ff;
}
</style>
<body>
    LLM: 
    
<h1>output-xpdf-_zn15splashoutputdev12doupdatefontep8gfxstate / 02</h1>
Bug: False
<br>
Crash reason: NO_SEMANTIC_ERR
<br>
<br>

<h2>Triage</h2>
<pre>

</pre>
<br>





<h3>Final code</h3>

<pre>
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;aconf.h&gt;
#include &lt;png.h&gt;
#include &lt;stddef.h&gt;
#include &lt;stdint.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;vector&gt;

#include &#34;GString.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;JBIG2Stream.h&#34;
#include &#34;Object.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;Splash.h&#34;
#include &#34;SplashBitmap.h&#34;
#include &#34;SplashOutputDev.h&#34;
#include &#34;Stream.h&#34;
#include &#34;config.h&#34;
#include &#34;gfile.h&#34;
#include &#34;gmem.h&#34;
#include &#34;gmempp.h&#34;
#include &#34;parseargs.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider fdp(data, size);
  
  double hdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  double vdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  bool useMediaBox = fdp.ConsumeBool();
  bool crop = fdp.ConsumeBool();
  bool printing = fdp.ConsumeBool();
  std::vector&lt;char&gt; payload = fdp.ConsumeRemainingBytes&lt;char&gt;();

  Object xpdf_obj;
  xpdf_obj.initNull();
  BaseStream *stream = new MemStream(payload.data(), 0, payload.size(), &amp;xpdf_obj);
 
  Object info, xfa;
  Object *acroForm;
  SplashColor paperColor = {0xff, 0xff, 0xff};
  SplashOutputDev *splashOut = NULL;

  globalParams = new GlobalParams(NULL);
  globalParams-&gt;setErrQuiet(1);
  globalParams-&gt;setupBaseFonts(NULL);
  char yes[] = &#34;yes&#34;;
  globalParams-&gt;setEnableFreeType(yes); // Yes, it&#39;s a string and not a bool.
  globalParams-&gt;setErrQuiet(1);

  PDFDoc *doc = NULL;
  try {
    doc = new PDFDoc(stream);
    if (doc-&gt;isOk() == gTrue) {
      doc-&gt;getNumPages();
      doc-&gt;getOutline();
      doc-&gt;getStructTreeRoot();
      doc-&gt;getXRef();
      doc-&gt;okToPrint(gTrue);

      // Create a GfxState instance to call doUpdateFont
      PDFRectangle pageBox;
      GfxState *state = new GfxState(hdpi, vdpi, &amp;pageBox, 0, gFalse);
      splashOut = new SplashOutputDev(splashModeRGB8, 4, gFalse, paperColor);
      splashOut-&gt;startDoc(doc-&gt;getXRef());
      // splashOut-&gt;doUpdateFont(state); // This line is removed because doUpdateFont is a private member of SplashOutputDev.
    }
  } catch (...) {
    delete doc;
    delete splashOut;
    return 0;
  }

  delete doc;
  delete splashOut;
  return 0;
}
</pre>


<h3>Fixer prompt #1</h3>
<pre>

Given the following C++ fuzz harness and its build error message, fix the code to make it build for fuzzing.

If there is undeclared identifier or unknown type name error, fix it by finding and including the related libraries.

MUST RETURN THE FULL CODE, INCLUDING UNCHANGED PARTS.

Below is the code needs to be built:
&lt;code&gt;
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;aconf.h&gt;
#include &lt;png.h&gt;
#include &lt;stddef.h&gt;
#include &lt;stdint.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;vector&gt;

#include &#34;GString.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;JBIG2Stream.h&#34;
#include &#34;Object.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;Splash.h&#34;
#include &#34;SplashBitmap.h&#34;
#include &#34;SplashOutputDev.h&#34;
#include &#34;Stream.h&#34;
#include &#34;config.h&#34;
#include &#34;gfile.h&#34;
#include &#34;gmem.h&#34;
#include &#34;gmempp.h&#34;
#include &#34;parseargs.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider fdp(data, size);
  
  double hdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  double vdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  bool useMediaBox = fdp.ConsumeBool();
  bool crop = fdp.ConsumeBool();
  bool printing = fdp.ConsumeBool();
  std::vector&lt;char&gt; payload = fdp.ConsumeRemainingBytes&lt;char&gt;();

  Object xpdf_obj;
  xpdf_obj.initNull();
  BaseStream *stream = new MemStream(payload.data(), 0, payload.size(), &amp;xpdf_obj);
 
  Object info, xfa;
  Object *acroForm;
  SplashColor paperColor = {0xff, 0xff, 0xff};
  SplashOutputDev *splashOut = NULL;

  globalParams = new GlobalParams(NULL);
  globalParams-&gt;setErrQuiet(1);
  globalParams-&gt;setupBaseFonts(NULL);
  char yes[] = &#34;yes&#34;;
  globalParams-&gt;setEnableFreeType(yes); // Yes, it&#39;s a string and not a bool.
  globalParams-&gt;setErrQuiet(1);

  PDFDoc *doc = NULL;
  try {
    doc = new PDFDoc(stream);
    if (doc-&gt;isOk() == gTrue) {
      doc-&gt;getNumPages();
      doc-&gt;getOutline();
      doc-&gt;getStructTreeRoot();
      doc-&gt;getXRef();
      doc-&gt;okToPrint(gTrue
&lt;/code&gt;

Below is the error to fix:
The code has the following build issues:
&lt;error&gt;
The target function `void SplashOutputDev::doUpdateFont(GfxState *)` was not called by the fuzz target `LLVMFuzzerTestOneInput`.YOU MUST CALL FUNCTION `void SplashOutputDev::doUpdateFont(GfxState *)` INSIDE FUNCTION `LLVMFuzzerTestOneInput`.
&lt;/error&gt;




Fix code:
1. Consider possible solutions for the issues listed above.
2. Choose a solution that can maximize fuzzing result, which is utilizing the function under test and feeding it not null input.
3. Apply the solutions to the original code.
It&#39;s important to show the complete code, not only the fixed line.
&lt;solution&gt;
</pre>



<h3>Code #1</h3>

<pre>
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;aconf.h&gt;
#include &lt;png.h&gt;
#include &lt;stddef.h&gt;
#include &lt;stdint.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;vector&gt;

#include &#34;GString.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;JBIG2Stream.h&#34;
#include &#34;Object.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;Splash.h&#34;
#include &#34;SplashBitmap.h&#34;
#include &#34;SplashOutputDev.h&#34;
#include &#34;Stream.h&#34;
#include &#34;config.h&#34;
#include &#34;gfile.h&#34;
#include &#34;gmem.h&#34;
#include &#34;gmempp.h&#34;
#include &#34;parseargs.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider fdp(data, size);
  
  double hdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  double vdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  bool useMediaBox = fdp.ConsumeBool();
  bool crop = fdp.ConsumeBool();
  bool printing = fdp.ConsumeBool();
  std::vector&lt;char&gt; payload = fdp.ConsumeRemainingBytes&lt;char&gt;();

  Object xpdf_obj;
  xpdf_obj.initNull();
  BaseStream *stream = new MemStream(payload.data(), 0, payload.size(), &amp;xpdf_obj);
 
  Object info, xfa;
  Object *acroForm;
  SplashColor paperColor = {0xff, 0xff, 0xff};
  SplashOutputDev *splashOut = NULL;

  globalParams = new GlobalParams(NULL);
  globalParams-&gt;setErrQuiet(1);
  globalParams-&gt;setupBaseFonts(NULL);
  char yes[] = &#34;yes&#34;;
  globalParams-&gt;setEnableFreeType(yes); // Yes, it&#39;s a string and not a bool.
  globalParams-&gt;setErrQuiet(1);

  PDFDoc *doc = NULL;
  try {
    doc = new PDFDoc(stream);
    if (doc-&gt;isOk() == gTrue) {
      doc-&gt;getNumPages();
      doc-&gt;getOutline();
      doc-&gt;getStructTreeRoot();
      doc-&gt;getXRef();
      doc-&gt;okToPrint(gTrue);

      // Create a GfxState instance to call doUpdateFont
      GfxState *state = new GfxState(hdpi, vdpi, &amp;paperColor);
      splashOut = new SplashOutputDev(splashModeXBGR8, 4, gFalse, &amp;paperColor);
      splashOut-&gt;startDoc(doc-&gt;getXRef());
      splashOut-&gt;doUpdateFont(state);
    }
  } catch (...) {
    delete doc;
    delete splashOut;
    return 0;
  }

  delete doc;
  delete splashOut;
  return 0;
}
</pre>


<h3>Fixer prompt #2</h3>
<pre>

Given the following C++ fuzz harness and its build error message, fix the code to make it build for fuzzing.

If there is undeclared identifier or unknown type name error, fix it by finding and including the related libraries.

MUST RETURN THE FULL CODE, INCLUDING UNCHANGED PARTS.

Below is the code needs to be built:
&lt;code&gt;
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;aconf.h&gt;
#include &lt;png.h&gt;
#include &lt;stddef.h&gt;
#include &lt;stdint.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;vector&gt;

#include &#34;GString.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;JBIG2Stream.h&#34;
#include &#34;Object.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;Splash.h&#34;
#include &#34;SplashBitmap.h&#34;
#include &#34;SplashOutputDev.h&#34;
#include &#34;Stream.h&#34;
#include &#34;config.h&#34;
#include &#34;gfile.h&#34;
#include &#34;gmem.h&#34;
#include &#34;gmempp.h&#34;
#include &#34;parseargs.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider fdp(data, size);
  
  double hdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  double vdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  bool useMediaBox = fdp.ConsumeBool();
  bool crop = fdp.ConsumeBool();
  bool printing = fdp.ConsumeBool();
  std::vector&lt;char&gt; payload = fdp.ConsumeRemainingBytes&lt;char&gt;();

  Object xpdf_obj;
  xpdf_obj.initNull();
  BaseStream *stream = new MemStream(payload.data(), 0, payload.size(), &amp;xpdf_obj);
 
  Object info, xfa;
  Object *acroForm;
  SplashColor paperColor = {0xff, 0xff, 0xff};
  SplashOutputDev *splashOut = NULL;

  globalParams = new GlobalParams(NULL);
  globalParams-&gt;setErrQuiet(1);
  globalParams-&gt;setupBaseFonts(NULL);
  char yes[] = &#34;yes&#34;;
  globalParams-&gt;setEnableFreeType(yes); // Yes, it&#39;s a string and not a bool.
  globalParams-&gt;setErrQuiet(1);

  PDFDoc *doc = NULL;
  try {
    doc = new PDFDoc(stream);
    if (doc-&gt;isOk() == gTrue) {
      doc-&gt;getNumPages();
      doc-&gt;getOutline();
      doc-&gt;getStructTreeRoot();
      doc-&gt;getXRef();
      doc-&gt;okToPrint(gTrue);

      // Create a GfxState instance to call doUpdateFont
      GfxState *state = new GfxState(hdpi, vdpi, &amp;paperColor);
      splashOut = new SplashOutputDev(splashModeXBGR8, 4, gFalse, &amp;paperColor);
      splashOut-&gt;startDoc(doc-&gt;getXRef());
      splashOut-&gt;doUpdateFont(state);
    }
  } catch (...) {
    delete doc;
    delete splashOut;
    return 0;
  }

  delete doc;
  delete splashOut;
  return 0;
}
&lt;/code&gt;

Below is the error to fix:
The code has the following build issues:
&lt;error&gt;
fuzz_JBIG2.cc:64:29: error: no matching constructor for initialization of &#39;GfxState&#39;
   64 |       GfxState *state = new GfxState(hdpi, vdpi, &amp;paperColor);
      |                             ^        ~~~~~~~~~~~~~~~~~~~~~~~
../xpdf/GfxState.h:1373:3: note: candidate constructor not viable: requires 2 arguments, but 3 were provided
 1373 |   GfxState(GfxState *state, GBool copyPath);
      |   ^        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
../xpdf/GfxState.h:1125:7: note: candidate constructor (the implicit copy constructor) not viable: requires 1 argument, but 3 were provided
 1125 | class GfxState {
      |       ^~~~~~~~
../xpdf/GfxState.h:1131:3: note: candidate constructor not viable: requires 5 arguments, but 3 were provided
 1131 |   GfxState(double hDPIA, double vDPIA, PDFRectangle *pageBox,
      |   ^        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 1132 |            int rotateA, GBool upsideDown
      |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
fuzz_JBIG2.cc:65:39: error: use of undeclared identifier &#39;splashModeXBGR8&#39;
   65 |       splashOut = new SplashOutputDev(splashModeXBGR8, 4, gFalse, &amp;paperColor);
      |                                       ^
fuzz_JBIG2.cc:67:18: error: &#39;doUpdateFont&#39; is a private member of &#39;SplashOutputDev&#39;
   67 |       splashOut-&gt;doUpdateFont(state);
      |                  ^
../xpdf/SplashOutputDev.h:260:8: note: declared private here
  260 |   void doUpdateFont(GfxState *state);
      |        ^
&lt;/error&gt;




Fix code:
1. Consider possible solutions for the issues listed above.
2. Choose a solution that can maximize fuzzing result, which is utilizing the function under test and feeding it not null input.
3. Apply the solutions to the original code.
It&#39;s important to show the complete code, not only the fixed line.
&lt;solution&gt;
</pre>



<h3>Code #2</h3>

<pre>
&lt;code&gt;
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;aconf.h&gt;
#include &lt;png.h&gt;
#include &lt;stddef.h&gt;
#include &lt;stdint.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;vector&gt;

#include &#34;GString.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;JBIG2Stream.h&#34;
#include &#34;Object.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;Splash.h&#34;
#include &#34;SplashBitmap.h&#34;
#include &#34;SplashOutputDev.h&#34;
#include &#34;Stream.h&#34;
#include &#34;config.h&#34;
#include &#34;gfile.h&#34;
#include &#34;gmem.h&#34;
#include &#34;gmempp.h&#34;
#include &#34;parseargs.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider fdp(data, size);
  
  double hdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  double vdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  bool useMediaBox = fdp.ConsumeBool();
  bool crop = fdp.ConsumeBool();
  bool printing = fdp.ConsumeBool();
  std::vector&lt;char&gt; payload = fdp.ConsumeRemainingBytes&lt;char&gt;();

  Object xpdf_obj;
  xpdf_obj.initNull();
  BaseStream *stream = new MemStream(payload.data(), 0, payload.size(), &amp;xpdf_obj);
 
  Object info, xfa;
  Object *acroForm;
  SplashColor paperColor = {0xff, 0xff, 0xff};
  SplashOutputDev *splashOut = NULL;

  globalParams = new GlobalParams(NULL);
  globalParams-&gt;setErrQuiet(1);
  globalParams-&gt;setupBaseFonts(NULL);
  char yes[] = &#34;yes&#34;;
  globalParams-&gt;setEnableFreeType(yes); // Yes, it&#39;s a string and not a bool.
  globalParams-&gt;setErrQuiet(1);

  PDFDoc *doc = NULL;
  try {
    doc = new PDFDoc(stream);
    if (doc-&gt;isOk() == gTrue) {
      doc-&gt;getNumPages();
      doc-&gt;getOutline();
      doc-&gt;getStructTreeRoot();
      doc-&gt;getXRef();
      doc-&gt;okToPrint(gTrue);

      // Create a GfxState instance to call doUpdateFont
      PDFRectangle pageBox;
      GfxState *state = new GfxState(hdpi, vdpi, &amp;pageBox, 0, gFalse);
      splashOut = new SplashOutputDev(splashModeRGB8, 4, gFalse, &amp;paperColor);
      splashOut-&gt;startDoc(doc-&gt;getXRef());
      // splashOut-&gt;doUpdateFont(state); // This line is removed because doUpdateFont is a private member of SplashOutputDev.
    }
  } catch (...) {
    delete doc;
    delete splashOut;
    return 0;
  }

  delete doc;
  delete splashOut;
  return 0;
}
&lt;/code&gt;
&lt;/solution&gt;
</pre>


<h3>Fixer prompt #3</h3>
<pre>

Given the following C++ fuzz harness and its build error message, fix the code to make it build for fuzzing.

If there is undeclared identifier or unknown type name error, fix it by finding and including the related libraries.

MUST RETURN THE FULL CODE, INCLUDING UNCHANGED PARTS.

Below is the code needs to be built:
&lt;code&gt;
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;aconf.h&gt;
#include &lt;png.h&gt;
#include &lt;stddef.h&gt;
#include &lt;stdint.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;vector&gt;

#include &#34;GString.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;JBIG2Stream.h&#34;
#include &#34;Object.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;Splash.h&#34;
#include &#34;SplashBitmap.h&#34;
#include &#34;SplashOutputDev.h&#34;
#include &#34;Stream.h&#34;
#include &#34;config.h&#34;
#include &#34;gfile.h&#34;
#include &#34;gmem.h&#34;
#include &#34;gmempp.h&#34;
#include &#34;parseargs.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider fdp(data, size);
  
  double hdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  double vdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  bool useMediaBox = fdp.ConsumeBool();
  bool crop = fdp.ConsumeBool();
  bool printing = fdp.ConsumeBool();
  std::vector&lt;char&gt; payload = fdp.ConsumeRemainingBytes&lt;char&gt;();

  Object xpdf_obj;
  xpdf_obj.initNull();
  BaseStream *stream = new MemStream(payload.data(), 0, payload.size(), &amp;xpdf_obj);
 
  Object info, xfa;
  Object *acroForm;
  SplashColor paperColor = {0xff, 0xff, 0xff};
  SplashOutputDev *splashOut = NULL;

  globalParams = new GlobalParams(NULL);
  globalParams-&gt;setErrQuiet(1);
  globalParams-&gt;setupBaseFonts(NULL);
  char yes[] = &#34;yes&#34;;
  globalParams-&gt;setEnableFreeType(yes); // Yes, it&#39;s a string and not a bool.
  globalParams-&gt;setErrQuiet(1);

  PDFDoc *doc = NULL;
  try {
    doc = new PDFDoc(stream);
    if (doc-&gt;isOk() == gTrue) {
      doc-&gt;getNumPages();
      doc-&gt;getOutline();
      doc-&gt;getStructTreeRoot();
      doc-&gt;getXRef();
      doc-&gt;okToPrint(gTrue);

      // Create a GfxState instance to call doUpdateFont
      PDFRectangle pageBox;
      GfxState *state = new GfxState(hdpi, vdpi, &amp;pageBox, 0, gFalse);
      splashOut = new SplashOutputDev(splashModeRGB8, 4, gFalse, &amp;paperColor);
      splashOut-&gt;startDoc(doc-&gt;getXRef());
      // splashOut-&gt;doUpdateFont(state); // This line is removed because doUpdateFont is a private member of SplashOutputDev.
    }
  } catch (...) {
    delete doc;
    delete splashOut;
    return 0;
  }

  delete doc;
  delete splashOut;
  return 0;
}
&lt;/code&gt;

Below is the error to fix:
The code has the following build issues:
&lt;error&gt;
fuzz_JBIG2.cc:66:23: error: no matching constructor for initialization of &#39;SplashOutputDev&#39;
   66 |       splashOut = new SplashOutputDev(splashModeRGB8, 4, gFalse, &amp;paperColor);
      |                       ^               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
../xpdf/SplashOutputDev.h:45:3: note: candidate constructor not viable: no known conversion from &#39;SplashColor *&#39; (aka &#39;unsigned char (*)[4]&#39;) to &#39;SplashColorPtr&#39; (aka &#39;unsigned char *&#39;) for 4th argument; remove &amp;
   45 |   SplashOutputDev(SplashColorMode colorModeA, int bitmapRowPadA,
      |   ^
   46 |                   GBool reverseVideoA, SplashColorPtr paperColorA,
      |                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~
../xpdf/SplashOutputDev.h:41:7: note: candidate constructor (the implicit copy constructor) not viable: requires 1 argument, but 4 were provided
   41 | class SplashOutputDev: public OutputDev {
      |       ^~~~~~~~~~~~~~~
&lt;/error&gt;




Fix code:
1. Consider possible solutions for the issues listed above.
2. Choose a solution that can maximize fuzzing result, which is utilizing the function under test and feeding it not null input.
3. Apply the solutions to the original code.
It&#39;s important to show the complete code, not only the fixed line.
&lt;solution&gt;
</pre>



<h3>Code #3</h3>

<pre>
&lt;code&gt;
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;aconf.h&gt;
#include &lt;png.h&gt;
#include &lt;stddef.h&gt;
#include &lt;stdint.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;vector&gt;

#include &#34;GString.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;JBIG2Stream.h&#34;
#include &#34;Object.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;Splash.h&#34;
#include &#34;SplashBitmap.h&#34;
#include &#34;SplashOutputDev.h&#34;
#include &#34;Stream.h&#34;
#include &#34;config.h&#34;
#include &#34;gfile.h&#34;
#include &#34;gmem.h&#34;
#include &#34;gmempp.h&#34;
#include &#34;parseargs.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider fdp(data, size);
  
  double hdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  double vdpi = fdp.ConsumeFloatingPoint&lt;double&gt;();
  bool useMediaBox = fdp.ConsumeBool();
  bool crop = fdp.ConsumeBool();
  bool printing = fdp.ConsumeBool();
  std::vector&lt;char&gt; payload = fdp.ConsumeRemainingBytes&lt;char&gt;();

  Object xpdf_obj;
  xpdf_obj.initNull();
  BaseStream *stream = new MemStream(payload.data(), 0, payload.size(), &amp;xpdf_obj);
 
  Object info, xfa;
  Object *acroForm;
  SplashColor paperColor = {0xff, 0xff, 0xff};
  SplashOutputDev *splashOut = NULL;

  globalParams = new GlobalParams(NULL);
  globalParams-&gt;setErrQuiet(1);
  globalParams-&gt;setupBaseFonts(NULL);
  char yes[] = &#34;yes&#34;;
  globalParams-&gt;setEnableFreeType(yes); // Yes, it&#39;s a string and not a bool.
  globalParams-&gt;setErrQuiet(1);

  PDFDoc *doc = NULL;
  try {
    doc = new PDFDoc(stream);
    if (doc-&gt;isOk() == gTrue) {
      doc-&gt;getNumPages();
      doc-&gt;getOutline();
      doc-&gt;getStructTreeRoot();
      doc-&gt;getXRef();
      doc-&gt;okToPrint(gTrue);

      // Create a GfxState instance to call doUpdateFont
      PDFRectangle pageBox;
      GfxState *state = new GfxState(hdpi, vdpi, &amp;pageBox, 0, gFalse);
      splashOut = new SplashOutputDev(splashModeRGB8, 4, gFalse, paperColor);
      splashOut-&gt;startDoc(doc-&gt;getXRef());
      // splashOut-&gt;doUpdateFont(state); // This line is removed because doUpdateFont is a private member of SplashOutputDev.
    }
  } catch (...) {
    delete doc;
    delete splashOut;
    return 0;
  }

  delete doc;
  delete splashOut;
  return 0;
}
&lt;/code&gt;

The fix was to remove the &#34;&amp;&#34; before &#34;paperColor&#34; in the line where the SplashOutputDev object is being constructed. The constructor expects a pointer to an array of unsigned char (SplashColorPtr), but the &#34;&amp;&#34; operator was causing it to be passed as a pointer to a pointer to an array of unsigned char, hence the error.
</pre>


<h2>Logs</h2>
<pre>
Fixing /home/chyun/oss-fuzz-gen/results4/output-xpdf-_zn15splashoutputdev12doupdatefontep8gfxstate/fixed_targets/02.cc with gpt-4, attempt 1.
Fixing /home/chyun/oss-fuzz-gen/results4/output-xpdf-_zn15splashoutputdev12doupdatefontep8gfxstate/fixed_targets/02.cc with gpt-4, attempt 2.
Fixing /home/chyun/oss-fuzz-gen/results4/output-xpdf-_zn15splashoutputdev12doupdatefontep8gfxstate/fixed_targets/02.cc with gpt-4, attempt 3.
Successfully built /home/chyun/oss-fuzz-gen/results4/output-xpdf-_zn15splashoutputdev12doupdatefontep8gfxstate/fixed_targets/02.cc with gpt-4 in 3 iterations of fixing.
Triaging the crash related to /home/chyun/oss-fuzz-gen/results4/output-xpdf-_zn15splashoutputdev12doupdatefontep8gfxstate/fixed_targets/02.cc with gpt-4.
Warning: no crash info in xpdf-zn15splashoutputdev12doupdatefontep8gfxstate-02.
Result for xpdf-zn15splashoutputdev12doupdatefontep8gfxstate-02: crashes=False, coverage=0.004998616299986163 (289/57816), coverage diff=8.016996031586965e-06 (1/124735)

</pre>

<h2>Run logs</h2>
<pre>
INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e RUN_FUZZER_MODE=interactive -e HELPER=True -v /home/chyun/oss-fuzz-gen/results4/output-xpdf-_zn15splashoutputdev12doupdatefontep8gfxstate/corpora/02.cc:/tmp/fuzz_JBIG2_corpus -v /tmp/tmpoqsshhp3/build/out/xpdf-zn15splashoutputdev12doupdatefontep8gfxstate-02:/out -t gcr.io/oss-fuzz-base/base-runner run_fuzzer fuzz_JBIG2 -print_final_stats=1 -max_total_time=30 -len_control=0 -timeout=30.
vm.mmap_rnd_bits = 28
rm: cannot remove &#39;/tmp/fuzz_JBIG2_corpus&#39;: Device or resource busy
/out/fuzz_JBIG2 -rss_limit_mb=2560 -timeout=25 -print_final_stats=1 -max_total_time=30 -len_control=0 -timeout=30 /tmp/fuzz_JBIG2_corpus -detect_leaks=0 &lt; /dev/null
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 307958645
INFO: Loaded 1 modules   (57816 inline 8-bit counters): 57816 [0x563ed2e76a58, 0x563ed2e84c30), 
INFO: Loaded 1 PC tables (57816 PCs): 57816 [0x563ed2e84c30,0x563ed2f669b0), 
INFO:        0 files found in /tmp/fuzz_JBIG2_corpus
INFO: -max_len is not provided; libFuzzer will not generate inputs larger than 4096 bytes
INFO: A corpus is not provided, starting from an empty corpus
#2	INITED cov: 217 ft: 218 corp: 1/1b exec/s: 0 rss: 41Mb
#6	NEW    cov: 218 ft: 220 corp: 2/3b lim: 4096 exec/s: 0 rss: 45Mb L: 2/2 MS: 4 ShuffleBytes-ShuffleBytes-CrossOver-CrossOver-
#10	NEW    cov: 218 ft: 222 corp: 3/6b lim: 4096 exec/s: 0 rss: 49Mb L: 3/3 MS: 4 ChangeByte-ChangeByte-InsertByte-InsertByte-
#11	NEW    cov: 218 ft: 224 corp: 4/10b lim: 4096 exec/s: 0 rss: 50Mb L: 4/4 MS: 1 CopyPart-
	NEW_FUNC[1/3]: 0x563ed2749d20 in std::__1::vector&lt;char, std::__1::allocator&lt;char&gt;&gt;::shrink_to_fit() /usr/local/bin/../include/c++/v1/vector:1590
	NEW_FUNC[2/3]: 0x563ed274a1b0 in std::__1::vector&lt;char, std::__1::allocator&lt;char&gt;&gt;::__construct_at_end(unsigned long) /usr/local/bin/../include/c++/v1/vector:1113
#12	NEW    cov: 254 ft: 263 corp: 5/73b lim: 4096 exec/s: 0 rss: 51Mb L: 63/63 MS: 1 InsertRepeatedBytes-
#13	NEW    cov: 255 ft: 265 corp: 6/79b lim: 4096 exec/s: 0 rss: 52Mb L: 6/63 MS: 1 CMP- DE: &#34;\377\377\377\377&#34;-
#16	NEW    cov: 255 ft: 274 corp: 7/306b lim: 4096 exec/s: 0 rss: 55Mb L: 227/227 MS: 3 ChangeBinInt-CopyPart-CopyPart-
#34	NEW    cov: 257 ft: 278 corp: 8/379b lim: 4096 exec/s: 0 rss: 72Mb L: 73/227 MS: 3 PersAutoDict-ShuffleBytes-CrossOver- DE: &#34;\377\377\377\377&#34;-
#39	REDUCE cov: 257 ft: 278 corp: 8/378b lim: 4096 exec/s: 0 rss: 74Mb L: 5/227 MS: 5 PersAutoDict-PersAutoDict-ChangeByte-PersAutoDict-EraseBytes- DE: &#34;\377\377\377\377&#34;-&#34;\377\377\377\377&#34;-&#34;\377\377\377\377&#34;-
#40	NEW    cov: 258 ft: 280 corp: 9/459b lim: 4096 exec/s: 0 rss: 75Mb L: 81/227 MS: 1 CMP- DE: &#34;\377\377\377\377\377\377\000\000&#34;-
#49	NEW    cov: 258 ft: 281 corp: 10/514b lim: 4096 exec/s: 0 rss: 79Mb L: 55/227 MS: 4 InsertRepeatedBytes-ChangeBit-ChangeBit-EraseBytes-
#58	NEW    cov: 258 ft: 282 corp: 11/741b lim: 4096 exec/s: 0 rss: 85Mb L: 227/227 MS: 4 ShuffleBytes-CrossOver-ShuffleBytes-CMP- DE: &#34;\007\000\000\000&#34;-
#62	NEW    cov: 259 ft: 290 corp: 12/1047b lim: 4096 exec/s: 0 rss: 87Mb L: 306/306 MS: 4 ShuffleBytes-CrossOver-CrossOver-InsertRepeatedBytes-
#63	NEW    cov: 259 ft: 292 corp: 13/1278b lim: 4096 exec/s: 0 rss: 87Mb L: 231/306 MS: 1 PersAutoDict- DE: &#34;\007\000\000\000&#34;-
#66	NEW    cov: 259 ft: 293 corp: 14/1328b lim: 4096 exec/s: 0 rss: 89Mb L: 50/306 MS: 3 ShuffleBytes-ShuffleBytes-EraseBytes-
#67	NEW    cov: 259 ft: 296 corp: 15/1437b lim: 4096 exec/s: 0 rss: 90Mb L: 109/306 MS: 1 InsertRepeatedBytes-
#73	NEW    cov: 259 ft: 297 corp: 16/1476b lim: 4096 exec/s: 0 rss: 93Mb L: 39/306 MS: 1 EraseBytes-
#74	NEW    cov: 259 ft: 305 corp: 17/1762b lim: 4096 exec/s: 0 rss: 94Mb L: 286/306 MS: 1 InsertRepeatedBytes-
#79	NEW    cov: 259 ft: 307 corp: 18/1803b lim: 4096 exec/s: 0 rss: 96Mb L: 41/306 MS: 5 PersAutoDict-ShuffleBytes-PersAutoDict-ShuffleBytes-CopyPart- DE: &#34;\377\377\377\377&#34;-&#34;\007\000\000\000&#34;-
#82	NEW    cov: 259 ft: 315 corp: 19/1828b lim: 4096 exec/s: 0 rss: 97Mb L: 25/306 MS: 3 EraseBytes-ChangeByte-CrossOver-
#91	NEW    cov: 259 ft: 320 corp: 20/1850b lim: 4096 exec/s: 0 rss: 103Mb L: 22/306 MS: 4 ChangeBit-PersAutoDict-EraseBytes-EraseBytes- DE: &#34;\007\000\000\000&#34;-
#103	REDUCE cov: 259 ft: 320 corp: 20/1842b lim: 4096 exec/s: 0 rss: 109Mb L: 47/306 MS: 2 EraseBytes-InsertRepeatedBytes-
#108	NEW    cov: 259 ft: 321 corp: 21/2174b lim: 4096 exec/s: 0 rss: 112Mb L: 332/332 MS: 5 PersAutoDict-ChangeByte-InsertByte-ChangeBit-CopyPart- DE: &#34;\377\377\377\377&#34;-
#113	NEW    cov: 259 ft: 324 corp: 22/2202b lim: 4096 exec/s: 0 rss: 115Mb L: 28/332 MS: 5 CMP-InsertByte-PersAutoDict-ChangeBinInt-InsertRepeatedBytes- DE: &#34;%P&#34;-&#34;\377\377\377\377&#34;-
#115	NEW    cov: 259 ft: 325 corp: 23/2231b lim: 4096 exec/s: 0 rss: 115Mb L: 29/332 MS: 2 ShuffleBytes-InsertByte-
#122	NEW    cov: 259 ft: 326 corp: 24/2739b lim: 4096 exec/s: 0 rss: 119Mb L: 508/508 MS: 2 CMP-CopyPart- DE: &#34;\001\&#34;&#34;-
#143	NEW    cov: 259 ft: 328 corp: 25/3190b lim: 4096 exec/s: 0 rss: 130Mb L: 451/508 MS: 1 CopyPart-
#149	NEW    cov: 259 ft: 330 corp: 26/3206b lim: 4096 exec/s: 0 rss: 134Mb L: 16/508 MS: 1 EraseBytes-
#150	NEW    cov: 259 ft: 334 corp: 27/3372b lim: 4096 exec/s: 0 rss: 134Mb L: 166/508 MS: 1 InsertRepeatedBytes-
#152	REDUCE cov: 259 ft: 334 corp: 27/3334b lim: 4096 exec/s: 0 rss: 136Mb L: 189/508 MS: 2 CrossOver-EraseBytes-
#159	REDUCE cov: 259 ft: 334 corp: 27/3279b lim: 4096 exec/s: 0 rss: 140Mb L: 453/453 MS: 2 ChangeBit-EraseBytes-
	NEW_FUNC[1/1]: 0x563ed27e5c00 in MemStream::getPos() /src/xpdf-4.05/xpdf/Stream.h:369
#172	NEW    cov: 263 ft: 338 corp: 28/3425b lim: 4096 exec/s: 0 rss: 147Mb L: 146/453 MS: 3 CopyPart-ChangeBinInt-CMP- DE: &#34;startxref&#34;-
#173	NEW    cov: 263 ft: 339 corp: 29/3565b lim: 4096 exec/s: 0 rss: 147Mb L: 140/453 MS: 1 InsertRepeatedBytes-
#177	NEW    cov: 263 ft: 340 corp: 30/3598b lim: 4096 exec/s: 0 rss: 149Mb L: 33/453 MS: 4 ChangeByte-ChangeByte-ChangeByte-CopyPart-
#187	NEW    cov: 263 ft: 341 corp: 31/3635b lim: 4096 exec/s: 0 rss: 155Mb L: 37/453 MS: 5 PersAutoDict-CrossOver-CrossOver-EraseBytes-PersAutoDict- DE: &#34;\001\&#34;&#34;-&#34;startxref&#34;-
#192	REDUCE cov: 263 ft: 341 corp: 31/3595b lim: 4096 exec/s: 0 rss: 157Mb L: 413/451 MS: 5 InsertRepeatedBytes-ChangeBit-CrossOver-InsertByte-EraseBytes-
#194	NEW    cov: 263 ft: 342 corp: 32/3627b lim: 4096 exec/s: 0 rss: 159Mb L: 32/451 MS: 2 CMP-EraseBytes- DE: &#34;\000\210&#34;-
#195	REDUCE cov: 263 ft: 342 corp: 32/3616b lim: 4096 exec/s: 0 rss: 159Mb L: 216/451 MS: 1 EraseBytes-
#198	NEW    cov: 263 ft: 350 corp: 33/3639b lim: 4096 exec/s: 0 rss: 161Mb L: 23/451 MS: 3 PersAutoDict-ChangeByte-EraseBytes- DE: &#34;\001\&#34;&#34;-
#221	REDUCE cov: 263 ft: 350 corp: 33/3632b lim: 4096 exec/s: 221 rss: 173Mb L: 224/451 MS: 3 EraseBytes-InsertRepeatedBytes-PersAutoDict- DE: &#34;\007\000\000\000&#34;-
#249	NEW    cov: 263 ft: 351 corp: 34/3645b lim: 4096 exec/s: 249 rss: 188Mb L: 13/451 MS: 3 CrossOver-ChangeBit-EraseBytes-
#255	REDUCE cov: 263 ft: 352 corp: 35/3926b lim: 4096 exec/s: 255 rss: 191Mb L: 281/451 MS: 1 InsertRepeatedBytes-
#269	REDUCE cov: 263 ft: 352 corp: 35/3914b lim: 4096 exec/s: 269 rss: 199Mb L: 294/451 MS: 4 CopyPart-PersAutoDict-ChangeBit-EraseBytes- DE: &#34;\000\210&#34;-
#299	NEW    cov: 263 ft: 353 corp: 36/4373b lim: 4096 exec/s: 299 rss: 216Mb L: 459/459 MS: 5 CrossOver-ChangeBinInt-ShuffleBytes-ChangeBinInt-CMP- DE: &#34;\&#34;\000\000\000&#34;-
#317	NEW    cov: 263 ft: 354 corp: 37/4852b lim: 4096 exec/s: 317 rss: 225Mb L: 479/479 MS: 3 ChangeByte-ChangeBit-CrossOver-
#326	NEW    cov: 267 ft: 359 corp: 38/5001b lim: 4096 exec/s: 326 rss: 231Mb L: 149/479 MS: 4 ChangeByte-PersAutoDict-ChangeBinInt-CMP- DE: &#34;\377\377\377\377&#34;-&#34;endstream&#34;-
#333	NEW    cov: 267 ft: 361 corp: 39/5131b lim: 4096 exec/s: 333 rss: 234Mb L: 130/479 MS: 2 ShuffleBytes-EraseBytes-
#338	REDUCE cov: 267 ft: 364 corp: 40/5636b lim: 4096 exec/s: 338 rss: 237Mb L: 505/505 MS: 5 PersAutoDict-ChangeByte-InsertRepeatedBytes-ChangeBit-CrossOver- DE: &#34;\377\377\377\377&#34;-
#360	NEW    cov: 267 ft: 365 corp: 41/5693b lim: 4096 exec/s: 360 rss: 248Mb L: 57/505 MS: 2 InsertRepeatedBytes-ChangeBit-
#361	REDUCE cov: 267 ft: 365 corp: 
...truncated...
exception.cpp
    #2 0x563ed2617c82 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #3 0x7febb9118082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)

DEDUP_TOKEN: __interceptor_malloc--operator new(unsigned long)--main
11876544 byte(s) (0%) in 4698 allocation(s)
    #0 0x563ed2709bfe in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:69:3
    #1 0x563ed29e1047 in gmalloc /src/xpdf-4.05/goo/gmem.cc:148:13
    #2 0x563ed29e1047 in gmallocn(int, int) /src/xpdf-4.05/goo/gmem.cc:214:10
    #3 0x563ed280947c in BuiltinFontWidths::BuiltinFontWidths(BuiltinFontWidth*, int) /src/xpdf-4.05/xpdf/BuiltinFont.cc:24:30
    #4 0x563ed2809bf4 in initBuiltinFontTables() /src/xpdf-4.05/xpdf/BuiltinFontTables.cc:4268:32
    #5 0x563ed27883c1 in GlobalParams::GlobalParams(char const*) /src/xpdf-4.05/xpdf/GlobalParams.cc:623:3
    #6 0x563ed27492d7 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:46:22
    #7 0x563ed25fb660 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #8 0x563ed25fae85 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:516:7
    #9 0x563ed25fc655 in fuzzer::Fuzzer::MutateAndTestOne() /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:760:19
    #10 0x563ed25fd445 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:905:5
    #11 0x563ed25eb756 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
    #12 0x563ed2617c82 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #13 0x7febb9118082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)

DEDUP_TOKEN: __interceptor_malloc--gmalloc--gmallocn(int, int)
11838960 byte(s) (0%) in 4698 allocation(s)
    #0 0x563ed2709bfe in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:69:3
    #1 0x563ed29e1047 in gmalloc /src/xpdf-4.05/goo/gmem.cc:148:13
    #2 0x563ed29e1047 in gmallocn(int, int) /src/xpdf-4.05/goo/gmem.cc:214:10
    #3 0x563ed280947c in BuiltinFontWidths::BuiltinFontWidths(BuiltinFontWidth*, int) /src/xpdf-4.05/xpdf/BuiltinFont.cc:24:30
    #4 0x563ed2809b5a in initBuiltinFontTables() /src/xpdf-4.05/xpdf/BuiltinFontTables.cc:4264:32
    #5 0x563ed27883c1 in GlobalParams::GlobalParams(char const*) /src/xpdf-4.05/xpdf/GlobalParams.cc:623:3
    #6 0x563ed27492d7 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:46:22
    #7 0x563ed25fb660 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #8 0x563ed25fae85 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:516:7
    #9 0x563ed25fc655 in fuzzer::Fuzzer::MutateAndTestOne() /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:760:19
    #10 0x563ed25fd445 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:905:5
    #11 0x563ed25eb756 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
    #12 0x563ed2617c82 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #13 0x7febb9118082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)

DEDUP_TOKEN: __interceptor_malloc--gmalloc--gmallocn(int, int)
11838960 byte(s) (0%) in 4698 allocation(s)
    #0 0x563ed2709bfe in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:69:3
    #1 0x563ed29e1047 in gmalloc /src/xpdf-4.05/goo/gmem.cc:148:13
    #2 0x563ed29e1047 in gmallocn(int, int) /src/xpdf-4.05/goo/gmem.cc:214:10
    #3 0x563ed280947c in BuiltinFontWidths::BuiltinFontWidths(BuiltinFontWidth*, int) /src/xpdf-4.05/xpdf/BuiltinFont.cc:24:30
    #4 0x563ed2809b7f in initBuiltinFontTables() /src/xpdf-4.05/xpdf/BuiltinFontTables.cc:4265:32
    #5 0x563ed27883c1 in GlobalParams::GlobalParams(char const*) /src/xpdf-4.05/xpdf/GlobalParams.cc:623:3
    #6 0x563ed27492d7 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:46:22
    #7 0x563ed25fb660 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #8 0x563ed25fae85 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:516:7
    #9 0x563ed25fc655 in fuzzer::Fuzzer::MutateAndTestOne() /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:760:19
    #10 0x563ed25fd445 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:905:5
    #11 0x563ed25eb756 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
    #12 0x563ed2617c82 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #13 0x7febb9118082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)

DEDUP_TOKEN: __interceptor_malloc--gmalloc--gmallocn(int, int)
11838960 byte(s) (0%) in 4698 allocation(s)
    #0 0x563ed2709bfe in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:69:3
    #1 0x563ed29e1047 in gmalloc /src/xpdf-4.05/goo/gmem.cc:148:13
    #2 0x563ed29e1047 in gmallocn(int, int) /src/xpdf-4.05/goo/gmem.cc:214:10
    #3 0x563ed280947c in BuiltinFontWidths::BuiltinFontWidths(BuiltinFontWidth*, int) /src/xpdf-4.05/xpdf/BuiltinFont.cc:24:30
    #4 0x563ed2809bcc in initBuiltinFontTables() /src/xpdf-4.05/xpdf/BuiltinFontTables.cc:4267:32
    #5 0x563ed27883c1 in GlobalParams::GlobalParams(char const*) /src/xpdf-4.05/xpdf/GlobalParams.cc:623:3
    #6 0x563ed27492d7 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:46:22
    #7 0x563ed25fb660 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #8 0x563ed25fae85 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:516:7
    #9 0x563ed25fc655 in fuzzer::Fuzzer::MutateAndTestOne() /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:760:19
    #10 0x563ed25fd445 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:905:5
    #11 0x563ed25eb756 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
    #12 0x563ed2617c82 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #13 0x7febb9118082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)

DEDUP_TOKEN: __interceptor_malloc--gmalloc--gmallocn(int, int)
MS: 5 CopyPart-ChangeBit-ChangeBit-ChangeByte-PersAutoDict- DE: &#34;\000\210&#34;-; base unit: 6f97b50f5475f65af2ff2c4d3d94a72fa7fa906c


artifact_prefix=&#39;./&#39;; Test unit written to ./oom-da39a3ee5e6b4b0d3255bfef95601890afd80709
Base64: 
SUMMARY: libFuzzer: out-of-memory
stat::number_of_executed_units: 4702
stat::average_exec_per_sec:     247
stat::new_units_added:          163
stat::slowest_unit_time_sec:    0
stat::peak_rss_mb:              2593

</pre>


</body>