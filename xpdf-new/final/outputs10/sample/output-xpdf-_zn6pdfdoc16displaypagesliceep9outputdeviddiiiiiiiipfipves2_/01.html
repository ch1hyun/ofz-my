<!doctype html>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Experiment results</title>
<style>
* {
    box-sizing: border-box;
}

html {
    line-height: 1.15;
}

body {
    font-family: sans-serif;
    font-size: 16px;
}

table {
    border-collapse: collapse;
    border-spacing: 0;
}

td, th {
    border-right: 1px #dedede solid;
    border-bottom: 1px #dedede solid;
    padding: 5px;
    text-align: left;
}
td:first-child, th:first-child {
    border-left: 1px #dedede solid;
}
th {
    border-top: 1px #dedede solid;
}

tbody tr:nth-child(odd) {
    background-color: #f4f5ff;
}
</style>
<body>
    LLM: 
    
<h1>output-xpdf-_zn6pdfdoc16displaypagesliceep9outputdeviddiiiiiiiipfipves2_ / 01</h1>
Bug: False
<br>
Crash reason: -
<br>
<br>

<h2>Triage</h2>
<pre>

</pre>
<br>





<h3>Final code</h3>

<pre>
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;stdint.h&gt;
#include &lt;stddef.h&gt;

#include &#34;Object.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;GString.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider stream(data, size);
  
  int page = stream.ConsumeIntegral&lt;int&gt;();
  double hDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  double vDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  int rotate = stream.ConsumeIntegral&lt;int&gt;();
  GBool useMediaBox = stream.ConsumeBool();
  GBool crop = stream.ConsumeBool();
  GBool printing = stream.ConsumeBool();
  int sliceX = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceY = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceW = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceH = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  std::vector&lt;char&gt; buf = stream.ConsumeRemainingBytes&lt;char&gt;();

  globalParams = new GlobalParams(&#34;/usr/local/etc/xpdfrc&#34;);
  globalParams-&gt;setupBaseFonts(&#34;/usr/share/ghostscript/9.25/Resource/cidfmap&#34;);

  Object obj;
  MemStream *str = new MemStream(buf.data(), 0, buf.size(), &amp;obj);
  PDFDoc *doc = new PDFDoc(str, NULL, NULL, NULL);
  
  if (doc-&gt;isOk()) {
    OutputDev *dev = new SplashOutputDev(splashModeRGB8, 4, gFalse, splashWhite);
    doc-&gt;displayPageSlice(dev, page, hDPI, vDPI, rotate, useMediaBox, crop, printing, sliceX, sliceY, sliceW, sliceH, NULL, NULL);
    delete dev;
  }

  delete doc;
  // Move the deletion of `str` after the deletion of `doc` to avoid heap-use-after-free error.
  delete str;  
  delete globalParams;
  
  return 0;
}
</pre>


<h3>Fixer prompt #1</h3>
<pre>

Given the following C++ fuzz harness and its build error message, fix the code to make it build for fuzzing.

If there is undeclared identifier or unknown type name error, fix it by finding and including the related libraries.

MUST RETURN THE FULL CODE, INCLUDING UNCHANGED PARTS.

Below is the code needs to be built:
&lt;code&gt;
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;stdint.h&gt;
#include &lt;stddef.h&gt;

#include &#34;Object.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;GString.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider stream(data, size);
  
  int page = stream.ConsumeIntegral&lt;int&gt;();
  double hDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  double vDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  int rotate = stream.ConsumeIntegral&lt;int&gt;();
  GBool useMediaBox = stream.ConsumeBool();
  GBool crop = stream.ConsumeBool();
  GBool printing = stream.ConsumeBool();
  int sliceX = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceY = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceW = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceH = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  std::vector&lt;char&gt; buf = stream.ConsumeRemainingBytes&lt;char&gt;();

  globalParams = new GlobalParams(&#34;/usr/local/etc/xpdfrc&#34;);
  globalParams-&gt;setupBaseFonts(&#34;/usr/share/ghostscript/9.25/Resource/cidfmap&#34;);

  Object obj;
  MemStream *str = new MemStream(buf.data(), 0, buf.size(), &amp;obj);
  PDFDoc *doc = new PDFDoc(str, NULL, NULL, NULL);
  
  if (doc-&gt;isOk()) {
    OutputDev *dev = NULL;
    doc-&gt;displayPageSlice(dev, page, hDPI, vDPI, rotate, useMediaBox, crop, printing, sliceX, sliceY, sliceW, sliceH, NULL, NULL);
  }

  delete
&lt;/code&gt;

Below is the error to fix:
The code has the following build issues:
&lt;error&gt;
fuzz_JBIG2.cc:39:9: error: expected expression
   39 |   delete
      |         ^
fuzz_JBIG2.cc:39:9: error: expected &#39;}&#39;
fuzz_JBIG2.cc:11:73: note: to match this &#39;{&#39;
   11 | extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
      |                                                                         ^
&lt;/error&gt;




Fix code:
1. Consider possible solutions for the issues listed above.
2. Choose a solution that can maximize fuzzing result, which is utilizing the function under test and feeding it not null input.
3. Apply the solutions to the original code.
It&#39;s important to show the complete code, not only the fixed line.
&lt;solution&gt;
</pre>



<h3>Code #1</h3>

<pre>
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;stdint.h&gt;
#include &lt;stddef.h&gt;

#include &#34;Object.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;GString.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider stream(data, size);
  
  int page = stream.ConsumeIntegral&lt;int&gt;();
  double hDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  double vDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  int rotate = stream.ConsumeIntegral&lt;int&gt;();
  GBool useMediaBox = stream.ConsumeBool();
  GBool crop = stream.ConsumeBool();
  GBool printing = stream.ConsumeBool();
  int sliceX = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceY = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceW = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceH = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  std::vector&lt;char&gt; buf = stream.ConsumeRemainingBytes&lt;char&gt;();

  globalParams = new GlobalParams(&#34;/usr/local/etc/xpdfrc&#34;);
  globalParams-&gt;setupBaseFonts(&#34;/usr/share/ghostscript/9.25/Resource/cidfmap&#34;);

  Object obj;
  MemStream *str = new MemStream(buf.data(), 0, buf.size(), &amp;obj);
  PDFDoc *doc = new PDFDoc(str, NULL, NULL, NULL);
  
  if (doc-&gt;isOk()) {
    OutputDev *dev = NULL;
    doc-&gt;displayPageSlice(dev, page, hDPI, vDPI, rotate, useMediaBox, crop, printing, sliceX, sliceY, sliceW, sliceH, NULL, NULL);
  }

  delete doc;
  delete str;
  delete globalParams;
  
  return 0;
}
&lt;/solution&gt;
</pre>


<h3>Fixer prompt #2</h3>
<pre>

Given the following C++ fuzz harness and its build error message, fix the code to make it build for fuzzing.

If there is undeclared identifier or unknown type name error, fix it by finding and including the related libraries.

MUST RETURN THE FULL CODE, INCLUDING UNCHANGED PARTS.

Below is the code needs to be built:
&lt;code&gt;
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;stdint.h&gt;
#include &lt;stddef.h&gt;

#include &#34;Object.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;GString.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider stream(data, size);
  
  int page = stream.ConsumeIntegral&lt;int&gt;();
  double hDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  double vDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  int rotate = stream.ConsumeIntegral&lt;int&gt;();
  GBool useMediaBox = stream.ConsumeBool();
  GBool crop = stream.ConsumeBool();
  GBool printing = stream.ConsumeBool();
  int sliceX = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceY = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceW = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceH = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  std::vector&lt;char&gt; buf = stream.ConsumeRemainingBytes&lt;char&gt;();

  globalParams = new GlobalParams(&#34;/usr/local/etc/xpdfrc&#34;);
  globalParams-&gt;setupBaseFonts(&#34;/usr/share/ghostscript/9.25/Resource/cidfmap&#34;);

  Object obj;
  MemStream *str = new MemStream(buf.data(), 0, buf.size(), &amp;obj);
  PDFDoc *doc = new PDFDoc(str, NULL, NULL, NULL);
  
  if (doc-&gt;isOk()) {
    OutputDev *dev = NULL;
    doc-&gt;displayPageSlice(dev, page, hDPI, vDPI, rotate, useMediaBox, crop, printing, sliceX, sliceY, sliceW, sliceH, NULL, NULL);
  }

  delete doc;
  delete str;
  delete globalParams;
  
  return 0;
}
&lt;/code&gt;

Below is the error to fix:
The code can build successfully but has a runtime issue: Fuzzing crashed immediately at runtime (ASAN-ERROR: AddressSanitizer: heap-use-after-free on address 0x506000004e20 at pc 0x55bbad04ebc3 bp 0x7fff6a4a8fb0 sp 0x7fff6a4a8fa8), indicating fuzz target code for invoking the function under test is incorrect or unrobust.
&lt;error&gt;
Crash stacks:
Stack 0:
#0 0x55bbad04ebc2 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:40:3
#1 0x55bbacf00600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
#2 0x55bbacf01b01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
#3 0x55bbacf020e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
#4 0x55bbacef06f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
#5 0x55bbacf1cc22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
#6 0x7f27238e0082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)
#7 0x55bbacee186d in _start (/out/fuzz_JBIG2+0x1ca86d)
Stack 1:
#0 0x55bbad04c18d in operator delete(void*) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:152:3
#1 0x55bbad06c77f in PDFDoc::~PDFDoc() /src/xpdf-4.05/xpdf/PDFDoc.cc:352:5
#2 0x55bbad04e9f8 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:39:3
#3 0x55bbacf00600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
#4 0x55bbacf01b01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
#5 0x55bbacf020e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
#6 0x55bbacef06f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
#7 0x55bbacf1cc22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
#8 0x7f27238e0082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)
Stack 2:
#0 0x55bbad04b92d in operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:95:3
#1 0x55bbad04e8b6 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:31:20
#2 0x55bbacf00600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
#3 0x55bbacf01b01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
#4 0x55bbacf020e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
#5 0x55bbacef06f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
#6 0x55bbacf1cc22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
#7 0x7f27238e0082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)
&lt;/error&gt;




Fix code:
1. Consider possible solutions for the issues listed above.
2. Choose a solution that can maximize fuzzing result, which is utilizing the function under test and feeding it not null input.
3. Apply the solutions to the original code.
It&#39;s important to show the complete code, not only the fixed line.
&lt;solution&gt;
</pre>



<h3>Code #2</h3>

<pre>
The issue is due to the deletion of the `str` object before the `doc` object. The `doc` object uses `str` for its operation and deleting `str` before `doc` leads to heap-use-after-free error. To fix this, we need to delete `doc` before `str`.

Here&#39;s the fixed code:

```cpp
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;stdint.h&gt;
#include &lt;stddef.h&gt;

#include &#34;Object.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;GString.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider stream(data, size);
  
  int page = stream.ConsumeIntegral&lt;int&gt;();
  double hDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  double vDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  int rotate = stream.ConsumeIntegral&lt;int&gt;();
  GBool useMediaBox = stream.ConsumeBool();
  GBool crop = stream.ConsumeBool();
  GBool printing = stream.ConsumeBool();
  int sliceX = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceY = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceW = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceH = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  std::vector&lt;char&gt; buf = stream.ConsumeRemainingBytes&lt;char&gt;();

  globalParams = new GlobalParams(&#34;/usr/local/etc/xpdfrc&#34;);
  globalParams-&gt;setupBaseFonts(&#34;/usr/share/ghostscript/9.25/Resource/cidfmap&#34;);

  Object obj;
  MemStream *str = new MemStream(buf.data(), 0, buf.size(), &amp;obj);
  PDFDoc *doc = new PDFDoc(str, NULL, NULL, NULL);
  
  if (doc-&gt;isOk()) {
    OutputDev *dev = NULL;
    doc-&gt;displayPageSlice(dev, page, hDPI, vDPI, rotate, useMediaBox, crop, printing, sliceX, sliceY, sliceW, sliceH, NULL, NULL);
  }

  delete doc;
  delete globalParams;
  delete str;  // Move this line after the deletion of `doc` to avoid heap-use-after-free error.
  
  return 0;
}
```
</pre>


<h3>Fixer prompt #3</h3>
<pre>

Given the following C++ fuzz harness and its build error message, fix the code to make it build for fuzzing.

If there is undeclared identifier or unknown type name error, fix it by finding and including the related libraries.

MUST RETURN THE FULL CODE, INCLUDING UNCHANGED PARTS.

Below is the code needs to be built:
&lt;code&gt;
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;stdint.h&gt;
#include &lt;stddef.h&gt;

#include &#34;Object.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;GString.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider stream(data, size);
  
  int page = stream.ConsumeIntegral&lt;int&gt;();
  double hDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  double vDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  int rotate = stream.ConsumeIntegral&lt;int&gt;();
  GBool useMediaBox = stream.ConsumeBool();
  GBool crop = stream.ConsumeBool();
  GBool printing = stream.ConsumeBool();
  int sliceX = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceY = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceW = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceH = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  std::vector&lt;char&gt; buf = stream.ConsumeRemainingBytes&lt;char&gt;();

  globalParams = new GlobalParams(&#34;/usr/local/etc/xpdfrc&#34;);
  globalParams-&gt;setupBaseFonts(&#34;/usr/share/ghostscript/9.25/Resource/cidfmap&#34;);

  Object obj;
  MemStream *str = new MemStream(buf.data(), 0, buf.size(), &amp;obj);
  PDFDoc *doc = new PDFDoc(str, NULL, NULL, NULL);
  
  if (doc-&gt;isOk()) {
    OutputDev *dev = NULL;
    doc-&gt;displayPageSlice(dev, page, hDPI, vDPI, rotate, useMediaBox, crop, printing, sliceX, sliceY, sliceW, sliceH, NULL, NULL);
  }

  delete doc;
  delete globalParams;
  delete str;  // Move this line after the deletion of `doc` to avoid heap-use-after-free error.
  
  return 0;
}
&lt;/code&gt;

Below is the error to fix:
The code can build successfully but has a runtime issue: Fuzzing crashed immediately at runtime (ASAN-ERROR: AddressSanitizer: heap-use-after-free on address 0x506000004e20 at pc 0x55aa35a38b6a bp 0x7ffdf74c3d10 sp 0x7ffdf74c3d08), indicating fuzz target code for invoking the function under test is incorrect or unrobust.
&lt;error&gt;
Crash stacks:
Stack 0:
#0 0x55aa35a38b69 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:41:3
#1 0x55aa358ea600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
#2 0x55aa358ebb01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
#3 0x55aa358ec0e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
#4 0x55aa358da6f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
#5 0x55aa35906c22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
#6 0x7f5d96849082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)
#7 0x55aa358cb86d in _start (/out/fuzz_JBIG2+0x1ca86d)
Stack 1:
#0 0x55aa35a3618d in operator delete(void*) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:152:3
#1 0x55aa35a5671f in PDFDoc::~PDFDoc() /src/xpdf-4.05/xpdf/PDFDoc.cc:352:5
#2 0x55aa35a38997 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:39:3
#3 0x55aa358ea600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
#4 0x55aa358ebb01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
#5 0x55aa358ec0e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
#6 0x55aa358da6f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
#7 0x55aa35906c22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
#8 0x7f5d96849082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)
Stack 2:
#0 0x55aa35a3592d in operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:95:3
#1 0x55aa35a38852 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:31:20
#2 0x55aa358ea600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
#3 0x55aa358ebb01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
#4 0x55aa358ec0e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
#5 0x55aa358da6f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
#6 0x55aa35906c22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
#7 0x7f5d96849082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)
&lt;/error&gt;




Fix code:
1. Consider possible solutions for the issues listed above.
2. Choose a solution that can maximize fuzzing result, which is utilizing the function under test and feeding it not null input.
3. Apply the solutions to the original code.
It&#39;s important to show the complete code, not only the fixed line.
&lt;solution&gt;
</pre>



<h3>Code #3</h3>

<pre>
Here is the fixed code:

```cpp
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;stdint.h&gt;
#include &lt;stddef.h&gt;

#include &#34;Object.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;GString.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider stream(data, size);
  
  int page = stream.ConsumeIntegral&lt;int&gt;();
  double hDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  double vDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  int rotate = stream.ConsumeIntegral&lt;int&gt;();
  GBool useMediaBox = stream.ConsumeBool();
  GBool crop = stream.ConsumeBool();
  GBool printing = stream.ConsumeBool();
  int sliceX = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceY = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceW = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceH = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  std::vector&lt;char&gt; buf = stream.ConsumeRemainingBytes&lt;char&gt;();

  globalParams = new GlobalParams(&#34;/usr/local/etc/xpdfrc&#34;);
  globalParams-&gt;setupBaseFonts(&#34;/usr/share/ghostscript/9.25/Resource/cidfmap&#34;);

  Object obj;
  MemStream *str = new MemStream(buf.data(), 0, buf.size(), &amp;obj);
  PDFDoc *doc = new PDFDoc(str, NULL, NULL, NULL);
  
  if (doc-&gt;isOk()) {
    OutputDev *dev = NULL;
    doc-&gt;displayPageSlice(dev, page, hDPI, vDPI, rotate, useMediaBox, crop, printing, sliceX, sliceY, sliceW, sliceH, NULL, NULL);
  }

  delete doc;
  delete str;  // Move this line after the deletion of `doc` to avoid heap-use-after-free error.
  delete globalParams;
  
  return 0;
}
```

The issue was that the `str` object was being deleted before the `doc` object, which was still using it. To fix this, the deletion of `str` was moved to after the deletion of `doc`.
</pre>


<h3>Fixer prompt #4</h3>
<pre>

Given the following C++ fuzz harness and its build error message, fix the code to make it build for fuzzing.

If there is undeclared identifier or unknown type name error, fix it by finding and including the related libraries.

MUST RETURN THE FULL CODE, INCLUDING UNCHANGED PARTS.

Below is the code needs to be built:
&lt;code&gt;
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;stdint.h&gt;
#include &lt;stddef.h&gt;

#include &#34;Object.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;GString.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider stream(data, size);
  
  int page = stream.ConsumeIntegral&lt;int&gt;();
  double hDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  double vDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  int rotate = stream.ConsumeIntegral&lt;int&gt;();
  GBool useMediaBox = stream.ConsumeBool();
  GBool crop = stream.ConsumeBool();
  GBool printing = stream.ConsumeBool();
  int sliceX = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceY = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceW = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceH = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  std::vector&lt;char&gt; buf = stream.ConsumeRemainingBytes&lt;char&gt;();

  globalParams = new GlobalParams(&#34;/usr/local/etc/xpdfrc&#34;);
  globalParams-&gt;setupBaseFonts(&#34;/usr/share/ghostscript/9.25/Resource/cidfmap&#34;);

  Object obj;
  MemStream *str = new MemStream(buf.data(), 0, buf.size(), &amp;obj);
  PDFDoc *doc = new PDFDoc(str, NULL, NULL, NULL);
  
  if (doc-&gt;isOk()) {
    OutputDev *dev = NULL;
    doc-&gt;displayPageSlice(dev, page, hDPI, vDPI, rotate, useMediaBox, crop, printing, sliceX, sliceY, sliceW, sliceH, NULL, NULL);
  }

  delete doc;
  delete str;  // Move this line after the deletion of `doc` to avoid heap-use-after-free error.
  delete globalParams;
  
  return 0;
}
&lt;/code&gt;

Below is the error to fix:
The code can build successfully but has a runtime issue: Fuzzing crashed immediately at runtime (ASAN-ERROR: AddressSanitizer: heap-use-after-free on address 0x506000004e20 at pc 0x561effbd6bc3 bp 0x7ffdf88c32d0 sp 0x7ffdf88c32c8), indicating fuzz target code for invoking the function under test is incorrect or unrobust.
&lt;error&gt;
Crash stacks:
Stack 0:
#0 0x561effbd6bc2 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:40:3
#1 0x561effa88600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
#2 0x561effa89b01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
#3 0x561effa8a0e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
#4 0x561effa786f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
#5 0x561effaa4c22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
#6 0x7f70ea4ee082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)
#7 0x561effa6986d in _start (/out/fuzz_JBIG2+0x1ca86d)
Stack 1:
#0 0x561effbd418d in operator delete(void*) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:152:3
#1 0x561effbf477f in PDFDoc::~PDFDoc() /src/xpdf-4.05/xpdf/PDFDoc.cc:352:5
#2 0x561effbd69f8 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:39:3
#3 0x561effa88600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
#4 0x561effa89b01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
#5 0x561effa8a0e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
#6 0x561effa786f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
#7 0x561effaa4c22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
#8 0x7f70ea4ee082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)
Stack 2:
#0 0x561effbd392d in operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:95:3
#1 0x561effbd68b6 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:31:20
#2 0x561effa88600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
#3 0x561effa89b01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
#4 0x561effa8a0e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
#5 0x561effa786f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
#6 0x561effaa4c22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
#7 0x7f70ea4ee082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)
&lt;/error&gt;




Fix code:
1. Consider possible solutions for the issues listed above.
2. Choose a solution that can maximize fuzzing result, which is utilizing the function under test and feeding it not null input.
3. Apply the solutions to the original code.
It&#39;s important to show the complete code, not only the fixed line.
&lt;solution&gt;
</pre>



<h3>Code #4</h3>

<pre>
&lt;code&gt;
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;stdint.h&gt;
#include &lt;stddef.h&gt;

#include &#34;Object.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;GString.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider stream(data, size);
  
  int page = stream.ConsumeIntegral&lt;int&gt;();
  double hDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  double vDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  int rotate = stream.ConsumeIntegral&lt;int&gt;();
  GBool useMediaBox = stream.ConsumeBool();
  GBool crop = stream.ConsumeBool();
  GBool printing = stream.ConsumeBool();
  int sliceX = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceY = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceW = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceH = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  std::vector&lt;char&gt; buf = stream.ConsumeRemainingBytes&lt;char&gt;();

  globalParams = new GlobalParams(&#34;/usr/local/etc/xpdfrc&#34;);
  globalParams-&gt;setupBaseFonts(&#34;/usr/share/ghostscript/9.25/Resource/cidfmap&#34;);

  Object obj;
  MemStream *str = new MemStream(buf.data(), 0, buf.size(), &amp;obj);
  PDFDoc *doc = new PDFDoc(str, NULL, NULL, NULL);
  
  if (doc-&gt;isOk()) {
    OutputDev *dev = NULL;
    doc-&gt;displayPageSlice(dev, page, hDPI, vDPI, rotate, useMediaBox, crop, printing, sliceX, sliceY, sliceW, sliceH, NULL, NULL);
  }

  delete doc;
  // Move the deletion of `str` after the deletion of `doc` to avoid heap-use-after-free error.
  delete str;  
  delete globalParams;
  
  return 0;
}
&lt;/code&gt;
&lt;/solution&gt;
</pre>


<h3>Fixer prompt #5</h3>
<pre>

Given the following C++ fuzz harness and its build error message, fix the code to make it build for fuzzing.

If there is undeclared identifier or unknown type name error, fix it by finding and including the related libraries.

MUST RETURN THE FULL CODE, INCLUDING UNCHANGED PARTS.

Below is the code needs to be built:
&lt;code&gt;
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;stdint.h&gt;
#include &lt;stddef.h&gt;

#include &#34;Object.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;GString.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider stream(data, size);
  
  int page = stream.ConsumeIntegral&lt;int&gt;();
  double hDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  double vDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  int rotate = stream.ConsumeIntegral&lt;int&gt;();
  GBool useMediaBox = stream.ConsumeBool();
  GBool crop = stream.ConsumeBool();
  GBool printing = stream.ConsumeBool();
  int sliceX = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceY = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceW = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceH = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  std::vector&lt;char&gt; buf = stream.ConsumeRemainingBytes&lt;char&gt;();

  globalParams = new GlobalParams(&#34;/usr/local/etc/xpdfrc&#34;);
  globalParams-&gt;setupBaseFonts(&#34;/usr/share/ghostscript/9.25/Resource/cidfmap&#34;);

  Object obj;
  MemStream *str = new MemStream(buf.data(), 0, buf.size(), &amp;obj);
  PDFDoc *doc = new PDFDoc(str, NULL, NULL, NULL);
  
  if (doc-&gt;isOk()) {
    OutputDev *dev = NULL;
    doc-&gt;displayPageSlice(dev, page, hDPI, vDPI, rotate, useMediaBox, crop, printing, sliceX, sliceY, sliceW, sliceH, NULL, NULL);
  }

  delete doc;
  // Move the deletion of `str` after the deletion of `doc` to avoid heap-use-after-free error.
  delete str;  
  delete globalParams;
  
  return 0;
}
&lt;/code&gt;

Below is the error to fix:
The code can build successfully but has a runtime issue: Fuzzing crashed immediately at runtime (ASAN-ERROR: AddressSanitizer: heap-use-after-free on address 0x506000004e20 at pc 0x5609e19b8bc3 bp 0x7ffd2d1794b0 sp 0x7ffd2d1794a8), indicating fuzz target code for invoking the function under test is incorrect or unrobust.
&lt;error&gt;
Crash stacks:
Stack 0:
#0 0x5609e19b8bc2 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:41:3
#1 0x5609e186a600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
#2 0x5609e186bb01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
#3 0x5609e186c0e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
#4 0x5609e185a6f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
#5 0x5609e1886c22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
#6 0x7f5326caa082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)
#7 0x5609e184b86d in _start (/out/fuzz_JBIG2+0x1ca86d)
Stack 1:
#0 0x5609e19b618d in operator delete(void*) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:152:3
#1 0x5609e19d677f in PDFDoc::~PDFDoc() /src/xpdf-4.05/xpdf/PDFDoc.cc:352:5
#2 0x5609e19b89f8 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:39:3
#3 0x5609e186a600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
#4 0x5609e186bb01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
#5 0x5609e186c0e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
#6 0x5609e185a6f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
#7 0x5609e1886c22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
#8 0x7f5326caa082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)
Stack 2:
#0 0x5609e19b592d in operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:95:3
#1 0x5609e19b88b6 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:31:20
#2 0x5609e186a600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
#3 0x5609e186bb01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
#4 0x5609e186c0e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
#5 0x5609e185a6f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
#6 0x5609e1886c22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
#7 0x7f5326caa082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)
&lt;/error&gt;




Fix code:
1. Consider possible solutions for the issues listed above.
2. Choose a solution that can maximize fuzzing result, which is utilizing the function under test and feeding it not null input.
3. Apply the solutions to the original code.
It&#39;s important to show the complete code, not only the fixed line.
&lt;solution&gt;
</pre>



<h3>Code #5</h3>

<pre>
&lt;code&gt;
#include &lt;fuzzer/FuzzedDataProvider.h&gt;

#include &lt;stdint.h&gt;
#include &lt;stddef.h&gt;

#include &#34;Object.h&#34;
#include &#34;GlobalParams.h&#34;
#include &#34;PDFDoc.h&#34;
#include &#34;GString.h&#34;

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  FuzzedDataProvider stream(data, size);
  
  int page = stream.ConsumeIntegral&lt;int&gt;();
  double hDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  double vDPI = stream.ConsumeFloatingPoint&lt;double&gt;();
  int rotate = stream.ConsumeIntegral&lt;int&gt;();
  GBool useMediaBox = stream.ConsumeBool();
  GBool crop = stream.ConsumeBool();
  GBool printing = stream.ConsumeBool();
  int sliceX = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceY = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceW = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  int sliceH = stream.ConsumeIntegralInRange&lt;int&gt;(0, 1000);
  std::vector&lt;char&gt; buf = stream.ConsumeRemainingBytes&lt;char&gt;();

  globalParams = new GlobalParams(&#34;/usr/local/etc/xpdfrc&#34;);
  globalParams-&gt;setupBaseFonts(&#34;/usr/share/ghostscript/9.25/Resource/cidfmap&#34;);

  Object obj;
  MemStream *str = new MemStream(buf.data(), 0, buf.size(), &amp;obj);
  PDFDoc *doc = new PDFDoc(str, NULL, NULL, NULL);
  
  if (doc-&gt;isOk()) {
    OutputDev *dev = new SplashOutputDev(splashModeRGB8, 4, gFalse, splashWhite);
    doc-&gt;displayPageSlice(dev, page, hDPI, vDPI, rotate, useMediaBox, crop, printing, sliceX, sliceY, sliceW, sliceH, NULL, NULL);
    delete dev;
  }

  delete doc;
  // Move the deletion of `str` after the deletion of `doc` to avoid heap-use-after-free error.
  delete str;  
  delete globalParams;
  
  return 0;
}
&lt;/code&gt;
&lt;solution&gt;

The problem was that the OutputDev *dev was initialized with NULL. This caused the crash when the displayPageSlice method was called. The solution was to initialize the dev with a new SplashOutputDev instance. After using it, it is necessary to delete it to avoid memory leaks.
</pre>


<h2>Logs</h2>
<pre>
Fixing /home/chyun/oss-fuzz-gen/results10/output-xpdf-_zn6pdfdoc16displaypagesliceep9outputdeviddiiiiiiiipfipves2_/fixed_targets/01.cc with gpt-4, attempt 1.
Fixing /home/chyun/oss-fuzz-gen/results10/output-xpdf-_zn6pdfdoc16displaypagesliceep9outputdeviddiiiiiiiipfipves2_/fixed_targets/01.cc with gpt-4, attempt 2.
Fixing /home/chyun/oss-fuzz-gen/results10/output-xpdf-_zn6pdfdoc16displaypagesliceep9outputdeviddiiiiiiiipfipves2_/fixed_targets/01.cc with gpt-4, attempt 3.
Fixing /home/chyun/oss-fuzz-gen/results10/output-xpdf-_zn6pdfdoc16displaypagesliceep9outputdeviddiiiiiiiipfipves2_/fixed_targets/01.cc with gpt-4, attempt 4.
Fixing /home/chyun/oss-fuzz-gen/results10/output-xpdf-_zn6pdfdoc16displaypagesliceep9outputdeviddiiiiiiiipfipves2_/fixed_targets/01.cc with gpt-4, attempt 5.
Failed to build /home/chyun/oss-fuzz-gen/results10/output-xpdf-_zn6pdfdoc16displaypagesliceep9outputdeviddiiiiiiiipfipves2_/fixed_targets/01.cc with gpt-4 in 5 iterations of fixing.

</pre>

<h2>Run logs</h2>
<pre>
INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e RUN_FUZZER_MODE=interactive -e HELPER=True -v /home/chyun/oss-fuzz-gen/results10/output-xpdf-_zn6pdfdoc16displaypagesliceep9outputdeviddiiiiiiiipfipves2_/corpora/01.cc:/tmp/fuzz_JBIG2_corpus -v /tmp/tmp3dj7t1cn/build/out/xpdf-zn6pdfdoc16displaypagesliceep9outputdeviddiiiiiiiipfipves2-01:/out -t gcr.io/oss-fuzz-base/base-runner run_fuzzer fuzz_JBIG2 -print_final_stats=1 -max_total_time=30 -len_control=0 -timeout=30.
vm.mmap_rnd_bits = 28
rm: cannot remove &#39;/tmp/fuzz_JBIG2_corpus&#39;: Device or resource busy
/out/fuzz_JBIG2 -rss_limit_mb=2560 -timeout=25 -print_final_stats=1 -max_total_time=30 -len_control=0 -timeout=30 /tmp/fuzz_JBIG2_corpus -detect_leaks=0 &lt; /dev/null
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 1336441051
INFO: Loaded 1 modules   (26943 inline 8-bit counters): 26943 [0x5609e1dd14d8, 0x5609e1dd7e17), 
INFO: Loaded 1 PC tables (26943 PCs): 26943 [0x5609e1dd7e18,0x5609e1e41208), 
INFO:        0 files found in /tmp/fuzz_JBIG2_corpus
INFO: -max_len is not provided; libFuzzer will not generate inputs larger than 4096 bytes
Config Error: No display font for &#39;Courier&#39;
Config Error: No display font for &#39;Courier-Bold&#39;
Config Error: No display font for &#39;Courier-BoldOblique&#39;
Config Error: No display font for &#39;Courier-Oblique&#39;
Config Error: No display font for &#39;Helvetica&#39;
Config Error: No display font for &#39;Helvetica-Bold&#39;
Config Error: No display font for &#39;Helvetica-BoldOblique&#39;
Config Error: No display font for &#39;Helvetica-Oblique&#39;
Config Error: No display font for &#39;Symbol&#39;
Config Error: No display font for &#39;Times-Bold&#39;
Config Error: No display font for &#39;Times-BoldItalic&#39;
Config Error: No display font for &#39;Times-Italic&#39;
Config Error: No display font for &#39;Times-Roman&#39;
Config Error: No display font for &#39;ZapfDingbats&#39;
Syntax Warning: May not be a PDF file (continuing anyway)
Syntax Error: Couldn&#39;t read xref table
Syntax Warning: PDF file is damaged - attempting to reconstruct xref table...
Syntax Error: Couldn&#39;t find trailer dictionary
Syntax Error: Couldn&#39;t read xref table
=================================================================
[1m[31m==15==ERROR: AddressSanitizer: heap-use-after-free on address 0x506000004e20 at pc 0x5609e19b8bc3 bp 0x7ffd2d1794b0 sp 0x7ffd2d1794a8
[1m[0m[1m[34mREAD of size 8 at 0x506000004e20 thread T0[1m[0m
SCARINESS: 51 (8-byte-read-heap-use-after-free)
    #0 0x5609e19b8bc2 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:41:3
    #1 0x5609e186a600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #2 0x5609e186bb01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
    #3 0x5609e186c0e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
    #4 0x5609e185a6f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
    #5 0x5609e1886c22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #6 0x7f5326caa082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)
    #7 0x5609e184b86d in _start (/out/fuzz_JBIG2+0x1ca86d)

DEDUP_TOKEN: LLVMFuzzerTestOneInput--fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long)--fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;)
[1m[32m0x506000004e20 is located 0 bytes inside of 64-byte region [0x506000004e20,0x506000004e60)
[1m[0m[1m[35mfreed by thread T0 here:[1m[0m
    #0 0x5609e19b618d in operator delete(void*) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:152:3
    #1 0x5609e19d677f in PDFDoc::~PDFDoc() /src/xpdf-4.05/xpdf/PDFDoc.cc:352:5
    #2 0x5609e19b89f8 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:39:3
    #3 0x5609e186a600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #4 0x5609e186bb01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
    #5 0x5609e186c0e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
    #6 0x5609e185a6f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
    #7 0x5609e1886c22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #8 0x7f5326caa082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)

DEDUP_TOKEN: operator delete(void*)--PDFDoc::~PDFDoc()--LLVMFuzzerTestOneInput
[1m[35mpreviously allocated by thread T0 here:[1m[0m
    #0 0x5609e19b592d in operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:95:3
    #1 0x5609e19b88b6 in LLVMFuzzerTestOneInput /src/xpdf-4.05/build/fuzz_JBIG2.cc:31:20
    #2 0x5609e186a600 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #3 0x5609e186bb01 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:807:3
    #4 0x5609e186c0e7 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:867:3
    #5 0x5609e185a6f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
    #6 0x5609e1886c22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #7 0x7f5326caa082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)

DEDUP_TOKEN: operator new(unsigned long)--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long)
SUMMARY: AddressSanitizer: heap-use-after-free /src/xpdf-4.05/build/fuzz_JBIG2.cc:41:3 in LLVMFuzzerTestOneInput
Shadow bytes around the buggy address:
  0x506000004b80: [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m
  0x506000004c00: [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m
  0x506000004c80: [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m
  0x506000004d00: [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m
  0x506000004d80: [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m
=&gt;0x506000004e00: [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m[[1m[35mfd[1m[0m][1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m
  0x506000004e80: [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m
  0x506000004f00: [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m
  0x506000004f80: [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m
  0x506000005000: [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m
  0x506000005080: [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m [1m[35mfd[1m[0m
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           [1m[0m00[1m[0m
  Partially addressable: [1m[0m01[1m[0m [1m[0m02[1m[0m [1m[0m03[1m[0m [1m[0m04[1m[0m [1m[0m05[1m[0m [1m[0m06[1m[0m [1m[0m07[1m[0m 
  Heap left redzone:       [1m[31mfa[1m[0m
  Freed heap region:       [1m[35mfd[1m[0m
  Stack left redzone:      [1m[31mf1[1m[0m
  Stack mid redzone:       [1m[31mf2[1m[0m
  Stack right redzone:     [1m[31mf3[1m[0m
  Stack after return:      [1m[35mf5[1m[0m
  Stack use after scope:   [1m[35mf8[1m[0m
  Global redzone:          [1m[31mf9[1m[0m
  Global init order:       [1m[36mf6[1m[0m
  Poisoned by user:        [1m[34mf7[1m[0m
  Container overflow:      [1m[34mfc[1m[0m
  Array cookie:            [1m[31mac[1m[0m
  Intra object redzone:    [1m[33mbb[1m[0m
  ASan internal:           [1m[33mfe[1m[0m
  Left alloca redzone:     [1m[34mca[1m[0m
  Right alloca redzone:    [1m[34mcb[1m[0m
==15==ABORTING
MS: 0 ; base unit: 0000000000000000000000000000000000000000


artifact_prefix=&#39;./&#39;; Test unit written to ./crash-da39a3ee5e6b4b0d3255bfef95601890afd80709
Base64: 
stat::number_of_executed_units: 1
stat::average_exec_per_sec:     0
stat::new_units_added:          0
stat::slowest_unit_time_sec:    0
stat::peak_rss_mb:              38

</pre>


</body>